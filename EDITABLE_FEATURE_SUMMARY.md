# å¤–å–è´­ç‰©è½¦å•†å“å¯ç¼–è¾‘åŠŸèƒ½å®ç°æ€»ç»“

## ğŸ“‹ åŠŸèƒ½éœ€æ±‚
ä»å¤–å–å…¥å£è¿›å…¥çš„ç‚¹é¤é¡µé¢æ²¡æœ‰å·²ç‚¹é¡µé¢ï¼Œåªæœ‰ä¸€ä¸ªç‚¹é¤é¡µé¢ï¼ˆå«å¤–å–ï¼‰ã€‚éœ€è¦åœ¨è·å–è´­ç‰©è½¦ä¿¡æ¯æ¥å£çš„dishesé‡Œæ·»åŠ ä¸€ä¸ª`editable`å‚æ•°ï¼ˆboolç±»å‹ï¼‰ï¼Œé€šè¿‡å®ƒæ¥åˆ¤æ–­è´­ç‰©è½¦ä¸­çš„å•†å“èƒ½å¦å¢å‡ã€‚å¦‚æœä¸èƒ½å¢å‡ï¼Œåˆ™éšè—å¢å‡ç»„ä»¶ï¼Œåªæ˜¾ç¤ºæ•°é‡ï¼Œæ•°é‡ä¸å¯ç¼–è¾‘ã€‚

## âœ… å®ç°å†…å®¹

### 1. æ•°æ®æ¨¡å‹ä¿®æ”¹

#### 1.1 CartItemModel (APIå±‚)
**æ–‡ä»¶**: `packages/lib_domain/lib/entrity/cart/cart_item_model.dart`
- âœ… æ·»åŠ äº†`editable`å­—æ®µï¼š`@JsonKey(name: 'editable') bool? editable;`
- âœ… åœ¨æ„é€ å‡½æ•°ä¸­æ·»åŠ äº†`editable`å‚æ•°
- âœ… é‡æ–°ç”Ÿæˆäº†JSONåºåˆ—åŒ–ä»£ç 

#### 1.2 CartItem (ä¸šåŠ¡å±‚)
**æ–‡ä»¶**: `lib/pages/order/order_element/models.dart`
- âœ… æ·»åŠ äº†`editable`å­—æ®µï¼š`final bool? editable;`
- âœ… åœ¨æ„é€ å‡½æ•°ä¸­æ·»åŠ äº†`editable`å‚æ•°
- âœ… ä¿æŒå‘åå…¼å®¹æ€§ï¼ˆeditableé»˜è®¤ä¸ºnullï¼Œåœ¨UIå±‚å¤„ç†ä¸ºtrueï¼‰

### 2. æ•°æ®è½¬æ¢é€»è¾‘ä¿®æ”¹

#### 2.1 è´­ç‰©è½¦æ•°æ®è½¬æ¢
**æ–‡ä»¶**: `lib/pages/order/order_element/cart_manager.dart`
- âœ… åœ¨`convertApiCartToLocalCart`æ–¹æ³•ä¸­æ·»åŠ äº†`editable`å­—æ®µçš„ä¼ é€’
- âœ… ç¡®ä¿ä»APIè·å–çš„`editable`å­—æ®µæ­£ç¡®ä¼ é€’åˆ°`CartItem`ä¸­

#### 2.2 å¤–å–æ§åˆ¶å™¨
**æ–‡ä»¶**: `lib/pages/takeaway/takeaway_dish_controller.dart`
- âœ… åœ¨`addToCart`å’Œ`removeFromCart`æ–¹æ³•ä¸­è®¾ç½®`editable: true`
- âœ… å¤–å–æ·»åŠ çš„å•†å“é»˜è®¤å¯ç¼–è¾‘

### 3. UIç»„ä»¶ä¿®æ”¹

#### 3.1 æ•°é‡æ§åˆ¶ç»„ä»¶
**æ–‡ä»¶**: `lib/pages/takeaway/components/takeaway_quantity_input_widget.dart`
- âœ… æ ¹æ®`editable`å­—æ®µæ§åˆ¶å¢å‡æŒ‰é’®çš„æ˜¾ç¤º
- âœ… ä¸å¯ç¼–è¾‘æ—¶éšè—å¢å‡æŒ‰é’®ï¼Œåªæ˜¾ç¤ºæ•°é‡
- âœ… ä¸å¯ç¼–è¾‘æ—¶æ•°é‡æ˜¾ç¤ºä¸ºç°è‰²ï¼Œä¸å¯ç‚¹å‡»ç¼–è¾‘
- âœ… æ‰€æœ‰æ•°é‡æ“ä½œæ–¹æ³•éƒ½å¢åŠ äº†`editable`æ£€æŸ¥

**å…·ä½“ä¿®æ”¹**:
```dart
// æ£€æŸ¥æ˜¯å¦å¯ç¼–è¾‘ï¼Œé»˜è®¤ä¸ºtrueï¼ˆå‘åå…¼å®¹ï¼‰
final isEditable = widget.cartItem.editable ?? true;

// åªæœ‰å¯ç¼–è¾‘æ—¶æ‰æ˜¾ç¤ºå¢å‡æŒ‰é’®
if (isEditable) ...[
  _buildDecreaseButton(),
  SizedBox(width: 8),
],
_buildQuantityDisplay(isEditable),
if (isEditable) ...[
  SizedBox(width: 8),
  _buildIncreaseButton(),
],
```

## ğŸ¯ åŠŸèƒ½ç‰¹ç‚¹

### 1. å‘åå…¼å®¹æ€§
- âœ… `editable`å­—æ®µä¸ºå¯é€‰å‚æ•°ï¼Œé»˜è®¤ä¸º`null`
- âœ… UIå±‚å°†`null`å€¼å¤„ç†ä¸º`true`ï¼ˆå¯ç¼–è¾‘ï¼‰ï¼Œç¡®ä¿ç°æœ‰åŠŸèƒ½ä¸å—å½±å“
- âœ… ç°æœ‰ä»£ç æ— éœ€ä¿®æ”¹å³å¯æ­£å¸¸å·¥ä½œ

### 2. çµæ´»æ§åˆ¶
- âœ… æœåŠ¡å™¨å¯ä»¥é€šè¿‡APIè¿”å›`editable: false`æ¥ç¦ç”¨ç‰¹å®šå•†å“çš„ç¼–è¾‘åŠŸèƒ½
- âœ… å®¢æˆ·ç«¯æ ¹æ®`editable`å­—æ®µåŠ¨æ€æ§åˆ¶UIæ˜¾ç¤º
- âœ… æ”¯æŒéƒ¨åˆ†å•†å“å¯ç¼–è¾‘ï¼Œéƒ¨åˆ†å•†å“ä¸å¯ç¼–è¾‘çš„æ··åˆåœºæ™¯

### 3. ç”¨æˆ·ä½“éªŒ
- âœ… ä¸å¯ç¼–è¾‘çš„å•†å“æ•°é‡æ˜¾ç¤ºä¸ºç°è‰²ï¼Œè§†è§‰ä¸Šæ˜ç¡®è¡¨ç¤ºä¸å¯æ“ä½œ
- âœ… ä¸å¯ç¼–è¾‘çš„å•†å“ä¸æ˜¾ç¤ºå¢å‡æŒ‰é’®ï¼Œç•Œé¢æ›´ç®€æ´
- âœ… æ•°é‡è¾“å…¥æ¡†ä¸å¯ç‚¹å‡»ï¼Œé˜²æ­¢è¯¯æ“ä½œ

## ğŸ”§ ä½¿ç”¨æ–¹å¼

### æœåŠ¡å™¨ç«¯
åœ¨è´­ç‰©è½¦APIçš„å“åº”ä¸­ï¼Œä¸ºéœ€è¦ç¦ç”¨ç¼–è¾‘çš„å•†å“è®¾ç½®`editable: false`ï¼š

```json
{
  "dishes": [
    {
      "id": 1,
      "name": "ç‰¹ä»·èœå“",
      "quantity": 2,
      "editable": false  // æ­¤å•†å“ä¸å¯ç¼–è¾‘
    },
    {
      "id": 2,
      "name": "æ™®é€šèœå“",
      "quantity": 1,
      "editable": true   // æ­¤å•†å“å¯ç¼–è¾‘ï¼ˆæˆ–çœç•¥æ­¤å­—æ®µï¼‰
    }
  ]
}
```

### å®¢æˆ·ç«¯
å®¢æˆ·ç«¯ä¼šè‡ªåŠ¨æ ¹æ®`editable`å­—æ®µæ§åˆ¶UIæ˜¾ç¤ºï¼Œæ— éœ€é¢å¤–å¤„ç†ã€‚

## ğŸ§ª æµ‹è¯•éªŒè¯

### 1. å¯ç¼–è¾‘å•†å“
- âœ… æ˜¾ç¤ºå¢å‡æŒ‰é’®
- âœ… æ•°é‡å¯ä»¥ç‚¹å‡»ç¼–è¾‘
- âœ… æ•°é‡æ˜¾ç¤ºä¸ºæ­£å¸¸é¢œè‰²

### 2. ä¸å¯ç¼–è¾‘å•†å“
- âœ… éšè—å¢å‡æŒ‰é’®
- âœ… æ•°é‡ä¸å¯ç‚¹å‡»ç¼–è¾‘
- âœ… æ•°é‡æ˜¾ç¤ºä¸ºç°è‰²
- âœ… æ‰€æœ‰æ•°é‡æ“ä½œè¢«é˜»æ­¢

### 3. å‘åå…¼å®¹
- âœ… æ²¡æœ‰`editable`å­—æ®µçš„å•†å“é»˜è®¤å¯ç¼–è¾‘
- âœ… ç°æœ‰åŠŸèƒ½å®Œå…¨æ­£å¸¸

## ğŸ“ ä¿®æ”¹æ–‡ä»¶åˆ—è¡¨

1. `packages/lib_domain/lib/entrity/cart/cart_item_model.dart` - APIæ•°æ®æ¨¡å‹
2. `lib/pages/order/order_element/models.dart` - ä¸šåŠ¡æ•°æ®æ¨¡å‹
3. `lib/pages/order/order_element/cart_manager.dart` - æ•°æ®è½¬æ¢é€»è¾‘
4. `lib/pages/takeaway/takeaway_dish_controller.dart` - å¤–å–æ§åˆ¶å™¨
5. `lib/pages/takeaway/components/takeaway_quantity_input_widget.dart` - UIç»„ä»¶

## ğŸ‰ æ€»ç»“

æˆåŠŸå®ç°äº†å¤–å–è´­ç‰©è½¦å•†å“çš„å¯ç¼–è¾‘æ§åˆ¶åŠŸèƒ½ï¼š
- âœ… æ·»åŠ äº†`editable`å­—æ®µåˆ°æ•°æ®æ¨¡å‹
- âœ… ä¿®æ”¹äº†UIç»„ä»¶æ ¹æ®`editable`å­—æ®µæ§åˆ¶æ˜¾ç¤º
- âœ… ä¿æŒäº†å‘åå…¼å®¹æ€§
- âœ… æä¾›äº†çµæ´»çš„æœåŠ¡å™¨ç«¯æ§åˆ¶èƒ½åŠ›
- âœ… ä¼˜åŒ–äº†ç”¨æˆ·ä½“éªŒ

åŠŸèƒ½å·²å®Œå…¨å®ç°å¹¶å¯ä»¥æŠ•å…¥ä½¿ç”¨ï¼ğŸš€
